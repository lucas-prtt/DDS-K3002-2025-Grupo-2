<div th:fragment="mapa">
    <!-- Leaflet CSS y JS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

    <style>
        #map { height: 500px; width: 100%; margin-top: 1rem; }
    </style>

    <h2>Mapa de Hechos</h2>
    <div id="map"></div>

    <script th:inline="javascript">
        /*<![CDATA[*/
        var hechos = /*[[${hechosJson}]]*/ '[]';
        /*]]>*/
        console.log("Hechos en JS:", hechos); // Para verificar que llegan correctamente

        // Inicializamos el mapa centrado en Buenos Aires
        const map = L.map('map').setView([-34.6037, -58.3816], 12);

        // Capa de mapa de OpenStreetMap
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: 'Â© OpenStreetMap contributors',
            noWrap: true
        }).addTo(map);

        // Agregamos un marker por cada hecho
        hechos.forEach(h => {
            if (h.ubicacion && h.ubicacion.latitud && h.ubicacion.longitud) {
                L.marker([h.ubicacion.latitud, h.ubicacion.longitud])
                    .addTo(map)
                    .bindPopup(`<b>${h.titulo}</b><br>${h.descripcion}`);
            }
        });
        /*]]>*/
    </script>
</div>

<div th:fragment="hechosRecientes">

</div>

<div th:fragment="filtros">

</div>